<!DOCTYPE html>
<html>
<head>
  <title>Upload Test</title>
  <script src="https://www.gstatic.com/firebasejs/10.10.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.10.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.10.0/firebase-storage-compat.js"></script>
</head>
<body style="background:black;color:white;text-align:center;">
  <h2>Test Image Upload</h2>
  <input type="file" id="fileInput" accept="image/*"><br><br>
  <button id="uploadBtn">Upload</button><br><br>
  <img id="preview" src="#" style="display:none;width:100px;border-radius:50%;" />

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyD1YgjFsxh-xZfeHlrxt_0igmH6SBIMcuc",
      authDomain: "void-d9ec4.firebaseapp.com",
      projectId: "void-d9ec4",
      storageBucket: "void-d9ec4.appspot.com",
      appId: "1:267268035851:web:d535fe4175c06f170f3e0e"
    };
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const storage = firebase.storage();

    auth.onAuthStateChanged(user => {
      if (!user) {
        alert("You must be logged in to upload.");
        return;
      }

      document.getElementById('uploadBtn').addEventListener('click', () => {
        const file = document.getElementById('fileInput').files[0];
        if (!file) return alert("No file selected");

        const ref = storage.ref('profilePics/' + user.uid);
        ref.put(file)
          .then(() => ref.getDownloadURL())
          .then(url => {
            document.getElementById('preview').src = url;
            document.getElementById('preview').style.display = "block";
            console.log("Uploaded! URL:", url);
          })
          .catch(error => {
            console.error("Upload error:", error);
            alert("Upload failed: " + error.message);
          });
      });
    });
  </script>
</body>
</html>
