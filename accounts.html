<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>VOID - Accounts</title>
  <script src="https://www.gstatic.com/firebasejs/10.11.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.11.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.11.0/firebase-database-compat.js"></script>
  <style>
    body {
      background-color: black;
      color: white;
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
    }

    header {
      background-color: #111;
      padding: 10px 20px;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    header h1 {
      font-size: 24px;
    }

    nav {
      display: flex;
      gap: 15px;
    }

    nav a, nav button {
      color: white;
      background: none;
      border: none;
      cursor: pointer;
      font-size: 16px;
      text-decoration: none;
    }

    .container {
      max-width: 500px;
      margin: 40px auto;
      padding: 20px;
      background: #1a1a1a;
      border-radius: 8px;
    }

    input, textarea {
      width: 100%;
      margin-bottom: 15px;
      padding: 10px;
      border: none;
      border-radius: 4px;
    }

    button {
      background-color: #333;
      color: white;
      padding: 10px 20px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }

    .hidden {
      display: none;
    }

    img {
      max-width: 100%;
      border-radius: 4px;
      margin-bottom: 10px;
    }

    .nav-symbol {
      display: none;
    }
  </style>
</head>
<body>
  <header>
    <h1>VOID</h1>
    <nav>
      <a href="index.html">Home</a>
      <a href="view-profiles.html">View Profiles</a>
      <a href="global-chat.html">Global Chat</a>
      <a href="echoes.html">Echoes</a>
      <button id="editProfileBtn" class="hidden">Edit Profile</button>
      <button id="logoutBtn" class="hidden">Logout</button>
    </nav>
  </header>

  <div class="container" id="authContainer">
    <h2 id="authHeader">Login</h2>
    <input type="email" id="email" placeholder="Email">
    <input type="password" id="password" placeholder="Password">
    <button id="authBtn">Login</button>
    <p>
      <span id="toggleAuth">Don't have an account? Sign up</span>
    </p>
  </div>

  <div class="container hidden" id="profileContainer">
    <div id="viewMode">
      <img id="viewPic" src="" alt="Profile Picture">
      <p><strong>Name:</strong> <span id="viewName"></span></p>
      <p><strong>Age:</strong> <span id="viewAge"></span></p>
      <p><strong>Gender:</strong> <span id="viewGender"></span></p>
      <p><strong>Bio:</strong> <span id="viewBio"></span></p>
    </div>

    <div id="editMode" class="hidden">
      <input type="text" id="name" placeholder="Name">
      <input type="number" id="age" placeholder="Age">
      <input type="text" id="gender" placeholder="Gender">
      <textarea id="bio" placeholder="Bio"></textarea>
      <input type="url" id="picUrl" placeholder="Profile Picture URL">
      <button id="saveProfileBtn">Save Profile</button>
    </div>
  </div>

  <script>
    // Firebase Config
    const firebaseConfig = {
      apiKey: "AIzaSyD1YgjFsxh-xZfeHlrxt_0igmH6SBIMcuc",
      authDomain: "void-d9ec4.firebaseapp.com",
      databaseURL: "https://void-d9ec4-default-rtdb.firebaseio.com",
      projectId: "void-d9ec4",
      storageBucket: "void-d9ec4.firebasestorage.app",
      messagingSenderId: "267268035851",
      appId: "1:267268035851:web:1e5ab79c51db42160f3e0e",
      measurementId: "G-ZYMQ3Z6LC5"
    };

    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.database();

    const authContainer = document.getElementById('authContainer');
    const profileContainer = document.getElementById('profileContainer');
    const authHeader = document.getElementById('authHeader');
    const authBtn = document.getElementById('authBtn');
    const toggleAuth = document.getElementById('toggleAuth');

    const emailInput = document.getElementById('email');
    const passwordInput = document.getElementById('password');

    const viewMode = document.getElementById('viewMode');
    const editMode = document.getElementById('editMode');

    const viewName = document.getElementById('viewName');
    const viewAge = document.getElementById('viewAge');
    const viewGender = document.getElementById('viewGender');
    const viewBio = document.getElementById('viewBio');
    const viewPic = document.getElementById('viewPic');

    const nameInput = document.getElementById('name');
    const ageInput = document.getElementById('age');
    const genderInput = document.getElementById('gender');
    const bioInput = document.getElementById('bio');
    const picUrlInput = document.getElementById('picUrl');

    const saveProfileBtn = document.getElementById('saveProfileBtn');
    const editProfileBtn = document.getElementById('editProfileBtn');
    const logoutBtn = document.getElementById('logoutBtn');

    let isLogin = true;

    toggleAuth.addEventListener('click', () => {
      isLogin = !isLogin;
      authHeader.textContent = isLogin ? "Login" : "Sign Up";
      authBtn.textContent = isLogin ? "Login" : "Sign Up";
      toggleAuth.textContent = isLogin ? "Don't have an account? Sign up" : "Already have an account? Login";
    });

    authBtn.addEventListener('click', () => {
      const email = emailInput.value;
      const password = passwordInput.value;

      if (isLogin) {
        auth.signInWithEmailAndPassword(email, password)
          .then(() => loadProfile())
          .catch(err => alert(err.message));
      } else {
        auth.createUserWithEmailAndPassword(email, password)
          .then(() => {
            const user = auth.currentUser;
            db.ref("users/" + user.uid).set({
              name: "",
              age: "",
              gender: "",
              bio: "",
              picUrl: ""
            });
            loadProfile();
          })
          .catch(err => alert(err.message));
      }
    });

    logoutBtn.addEventListener('click', () => {
      auth.signOut().then(() => {
        profileContainer.classList.add('hidden');
        authContainer.classList.remove('hidden');
        logoutBtn.classList.add('hidden');
        editProfileBtn.classList.add('hidden');
      });
    });

    editProfileBtn.addEventListener('click', () => {
      viewMode.classList.add('hidden');
      editMode.classList.remove('hidden');
    });

    saveProfileBtn.addEventListener('click', () => {
      const user = auth.currentUser;
      const userRef = db.ref("users/" + user.uid);
      const profileData = {
        name: nameInput.value,
        age: ageInput.value,
        gender: genderInput.value,
        bio: bioInput.value,
        picUrl: picUrlInput.value
      };
      userRef.update(profileData).then(() => {
        loadProfile();
      });
    });

    function loadProfile() {
      const user = auth.currentUser;
      if (!user) return;

      const userRef = db.ref("users/" + user.uid);
      userRef.once("value").then(snapshot => {
        const data = snapshot.val();
        viewName.textContent = data.name;
        viewAge.textContent = data.age;
        viewGender.textContent = data.gender;
        viewBio.textContent = data.bio;
        viewPic.src = data.picUrl || "";

        nameInput.value = data.name || "";
        ageInput.value = data.age || "";
        genderInput.value = data.gender || "";
        bioInput.value = data.bio || "";
        picUrlInput.value = data.picUrl || "";

        authContainer.classList.add('hidden');
        profileContainer.classList.remove('hidden');
        viewMode.classList.remove('hidden');
        editMode.classList.add('hidden');
        logoutBtn.classList.remove('hidden');
        editProfileBtn.classList.remove('hidden');
      });
    }

    auth.onAuthStateChanged(user => {
      if (user) {
        loadProfile();
      }
    });
  </script>
</body>
</html>
